---
title: "CS 422"
output: 
  html_notebook:
    toc: yes
    toc_float: yes
author: Wenlong Li
---

### Part 2.1
```{r}
library("ISLR")
options(digits=2)
setwd("./")
set.seed(1122)
index <- sample(1:nrow(Auto), 0.95*dim(Auto)[1])
train.df <- Auto[index,]
test.df <- Auto[-index,]
print(test.df)
```
### Part 2.1-a
### Part 2.1-a-i
#### name is a string type and cannot be used directly, and name and mpg are basically irrelevant
### Part 2.1-a-ii

```{r}
library(dplyr)
library(modelr)
model <- lm(mpg = ~ ., data = select(train.df, -name))
summary(model)
rmse = rmse(model = model, data = select(train.df, -name))
str <- paste0("R-squared: 0.817 ","RSE: 3.4 ","RMSE: ",round(rmse, digits = 2))
print(str)
```
#### R2 = 0.817,RSE = 3.4,RMSE = 3.33, There is still a certain distance from the data fitting degree to perfection.
### Part 2.1-a-iii
```{r}
plot(model, 1)
```
### Part 2.1-a-iv
```{r}
hist(model$residuals, main = "Advertising Residual Histogram", xlab = "Model Residuals", density = 10, angle = 45, col = "red",
border = "blue", labels=T,  ylim=c(0,100))
```
#### the histogram follow a Gaussian distribution,Looks reasonably good as residuals appear homosceadastic and clustered around 0. (Though they donâ€™t appear to be normally distributed.)

### Part 2.1-b










